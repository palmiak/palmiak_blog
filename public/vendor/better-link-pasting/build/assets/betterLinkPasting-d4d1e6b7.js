document.addEventListener("DOMContentLoaded",function(){function f(...t){}function g(t){t.on("beforeChange",function(n,r){if(r.origin!=="paste"||!n.somethingSelected())return;const e=n.getSelection(),i=r.text.join(`
`);if(/^(https?:\/\/[^\s]+)$/.test(i.trim())){const a=`[${e}](${i.trim()})`;r.text=[a],r.update(r.from,r.to,r.text)}})}function p(){document.querySelectorAll(".CodeMirror").forEach(function(t){t.CodeMirror&&!t.hasUrlPasteHandler&&(g(t.CodeMirror),t.hasUrlPasteHandler=!0)})}function h(t){return/^(https?:\/\/[^\s]+)$/.test(t.trim())}let s={text:"",range:null,time:0,editorEl:null};function u(t){const n=window.getSelection();if(!n.rangeCount)return;const r=n.getRangeAt(0),e=n.toString().trim();e&&(s={text:e,range:r.cloneRange(),time:Date.now(),editorEl:t})}function w(t){let n=t;for(;n&&n!==document.body;){if(n.__vue__){let e=n.__vue__;for(;e;){if(e.editor)return e.editor;e=e.$parent}}n=n.parentNode}const r=document.querySelectorAll('.bard-editor, [data-fieldtype="bard"]');for(let e of r)if(e.contains(t)&&e.__vue__){let i=e.__vue__;for(;i;){if(i.editor)return i.editor;i=i.$parent}}if(window.Statamic&&window.Statamic.app){const e=o=>{if(o.editor&&o.$el&&o.$el.contains(t))return o.editor;if(o.$children)for(let a of o.$children){const c=e(a);if(c)return c}return null},i=e(window.Statamic.app);if(i)return i}return null}function m(t){t._hasPasteHandler||(t._hasPasteHandler=!0,t.addEventListener("mouseup",function(){u(t)}),t.addEventListener("keyup",function(n){["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End"].includes(n.key)&&u(t)}),t.addEventListener("paste",function(n){const r=n.clipboardData.getData("text");if(!h(r))return;if(!(s.text&&s.editorEl===t&&Date.now()-s.time<3e3)){const a=window.getSelection();if(!a.rangeCount)return;const c=a.getRangeAt(0);if(!t.contains(c.commonAncestorContainer))return;const l=a.toString().trim();if(!l)return;s={text:l,range:c.cloneRange(),time:Date.now(),editorEl:t}}const i=s.text;n.preventDefault(),n.stopPropagation();const o=w(t);if(o&&typeof o.chain=="function")try{t.focus();const a=window.getSelection();a.removeAllRanges(),a.addRange(s.range),o.chain().focus().deleteSelection().extendMarkRange("link").insertContent(`<a href="${r.trim()}">${i}</a>`).setLink({href:r.trim()}).run(),f("Created link using TipTap native JSON structure");return}catch{}}))}function x(){document.querySelectorAll('[contenteditable="true"]').forEach(t=>{m(t)})}function d(){p(),x()}d(),new MutationObserver(function(t){let n=!1;t.forEach(function(r){r.addedNodes&&r.addedNodes.length>0&&r.addedNodes.forEach(function(e){e.nodeType===1&&(e.classList&&e.classList.contains("CodeMirror")&&(n=!0),e.hasAttribute&&e.hasAttribute("contenteditable")&&(n=!0),e.querySelectorAll&&e.querySelectorAll('.CodeMirror, [contenteditable="true"]').length>0&&(n=!0))})}),n&&setTimeout(d,100)}).observe(document.body,{childList:!0,subtree:!0})});
